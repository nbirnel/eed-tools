<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>/cygdrive/u/SHARED/GENERAL/_SoftwareRepository/noahtools/doc2pdf/doc2pdf.vbs.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="vb">
<meta name="settings" content="use_css">
<style type="text/css">
<!--
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.Identifier { color: #8080ff; }
.PreProc { color: #ff40ff; }
.Constant { color: #ff40ff; }
.Statement { color: #c00000; }
.Comment { color: #ff6060; }
-->
</style>
</head>
<body>
<pre>
<span class="Comment">' C:&gt; cscript /nologo &lt;path to doc2pdf.vbs&gt; /nologo &lt;path to Word document&gt;</span>


<span class="Comment">'************************************************</span>
<span class="Comment">'</span>
<span class="Comment">' DOC2PDF.VBS Microsoft Scripting Host Script (Requires Version 5.6 or newer)</span>
<span class="Comment">' --------------------------------------------------------------------------------</span>
<span class="Comment">'</span>
<span class="Comment">' Author: Michael Suodenjoki</span>
<span class="Comment">' Created: 2007.07.07</span>
<span class="Comment">'</span>
<span class="Comment">' This script can create a PDF file from a Word document provided you're using</span>
<span class="Comment">' Word 2007 and have the 'Office Add-in: Save As PDF' installed.</span>
<span class="Comment">'</span>

<span class="Comment">' Constants</span>
<span class="Statement">Const</span> WdDoNotSaveChanges <span class="Statement">=</span> <span class="Constant">0</span>

<span class="Comment">' see WdSaveFormat enumeration constants: </span>
<span class="Comment">' <a href="http://msdn2.microsoft.com/en-us/library/bb238158.aspx">http://msdn2.microsoft.com/en-us/library/bb238158.aspx</a></span>
<span class="Statement">Const</span> wdFormatPDF <span class="Statement">=</span> <span class="Constant">17</span> <span class="Comment"> ' PDF format. </span>
<span class="Statement">Const</span> wdFormatXPS <span class="Statement">=</span> <span class="Constant">18</span> <span class="Comment"> ' XPS format. </span>


<span class="Comment">' Global variables</span>
<span class="Statement">Dim</span> arguments
<span class="Statement">Set</span> arguments <span class="Statement">=</span> WScript<span class="Statement">.</span>Arguments

<span class="Comment">' ***********************************************</span>
<span class="Comment">' ECHOLOGO</span>
<span class="Comment">'</span>
<span class="Comment">' Outputs the logo information.</span>
<span class="Comment">'</span>
<span class="Statement">Function</span> EchoLogo<span class="Statement">()</span>
  <span class="Statement">If</span> <span class="Statement">Not</span> <span class="Statement">(</span>arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;nologo&quot;</span><span class="Statement">)</span> <span class="Statement">Or</span> arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;n&quot;</span><span class="Statement">))</span> <span class="Statement">Then</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;doc2pdf Version 2.0, Michael Suodenjoki 2007&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;==================================================&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
  <span class="Statement">End</span> <span class="Statement">If</span>
<span class="Statement">End</span> <span class="Statement">Function</span>

<span class="Comment">' ***********************************************</span>
<span class="Comment">' ECHOUSAGE</span>
<span class="Comment">'</span>
<span class="Comment">' Outputs the usage information.</span>
<span class="Comment">'</span>
<span class="Statement">Function</span> EchoUsage<span class="Statement">()</span>
  <span class="Statement">If</span> arguments<span class="Statement">.</span><span class="PreProc">Count</span><span class="Statement">=</span><span class="Constant">0</span> <span class="Statement">Or</span> arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;help&quot;</span><span class="Statement">)</span> <span class="Statement">Or _</span>
    arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;h&quot;</span><span class="Statement">) _</span>
  <span class="Statement">Then</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Generates a PDF from a Word document file using Word 2007.&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Usage: doc2pdf.vbs &lt;options&gt; &lt;doc-file&gt; [/o:&lt;pdf-file&gt;]&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Available Options:&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot; /nologo - Specifies that the logo shouldn't be displayed&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot; /help   - Specifies that this usage/help information &quot;</span> <span class="Statement">+ _</span>
                 <span class="Constant">&quot;should be displayed.&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot; /debug  - Specifies that debug output should be displayed.&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Parameters:&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot; /o:&lt;pdf-file&gt; Optionally specification of output file (PDF).&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;&quot;</span>
  <span class="Statement">End</span> <span class="Statement">If</span>
<span class="Statement">End</span> <span class="Statement">Function</span>

<span class="Comment">' ***********************************************</span>
<span class="Comment">' CHECKARGS</span>
<span class="Comment">'</span>
<span class="Comment">' Makes some preliminary checks of the arguments.</span>
<span class="Comment">' Quits the application is any problem is found.</span>
<span class="Comment">'</span>
<span class="Statement">Function</span> CheckArgs<span class="Statement">()</span>
 <span class="Comment"> ' Check that &lt;doc-file&gt; is specified</span>
  <span class="Statement">If</span> arguments<span class="Statement">.</span>Unnamed<span class="Statement">.</span><span class="PreProc">Count</span> <span class="Statement">&lt;&gt;</span> <span class="Constant">1</span> <span class="Statement">Then</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Error: Obligatory &lt;doc-file&gt; parameter missing!&quot;</span>
    WScript<span class="Statement">.</span><span class="PreProc">Quit</span> <span class="Constant">1</span>
  <span class="Statement">End</span> <span class="Statement">If</span>

  bShowDebug <span class="Statement">=</span> arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;debug&quot;</span><span class="Statement">)</span> <span class="Statement">Or</span> arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Exists</span><span class="Statement">(</span><span class="Constant">&quot;d&quot;</span><span class="Statement">)</span>

<span class="Statement">End</span> <span class="Statement">Function</span>


<span class="Comment">' ***********************************************</span>
<span class="Comment">' DOC2PDF</span>
<span class="Comment">'</span>
<span class="Comment">' Converts a Word document to PDF using Word 2007.</span>
<span class="Comment">'</span>
<span class="Comment">' Input:</span>
<span class="Comment">' sDocFile - Full path to Word document.</span>
<span class="Comment">' sPDFFile - Optional full path to output file.</span>
<span class="Comment">'</span>
<span class="Comment">' If not specified the output PDF file</span>
<span class="Comment">' will be the same as the sDocFile except</span>
<span class="Comment">' file extension will be .pdf.</span>
<span class="Comment">'</span>
<span class="Statement">Function</span> DOC2PDF<span class="Statement">(</span> sDocFile<span class="Statement">,</span> sPDFFile <span class="Statement">)</span>

  <span class="Statement">Dim</span> fso<span class="Comment"> ' As FileSystemObject</span>
  <span class="Statement">Dim</span> wdo<span class="Comment"> ' As Word.Application</span>
  <span class="Statement">Dim</span> wdoc<span class="Comment"> ' As Word.Document</span>
  <span class="Statement">Dim</span> wdocs<span class="Comment"> ' As Word.Documents</span>
  <span class="Statement">Dim</span> sPrevPrinter<span class="Comment"> ' As String</span>

  <span class="Statement">Set</span> fso <span class="Statement">=</span> <span class="Identifier">CreateObject</span><span class="Statement">(</span><span class="Constant">&quot;Scripting.FileSystemObject&quot;</span><span class="Statement">)</span>
  <span class="Statement">Set</span> wdo <span class="Statement">=</span> <span class="Identifier">CreateObject</span><span class="Statement">(</span><span class="Constant">&quot;Word.Application&quot;</span><span class="Statement">)</span>
  <span class="Statement">Set</span> wdocs <span class="Statement">=</span> wdo<span class="Statement">.</span>Documents

  sDocFile <span class="Statement">=</span> fso<span class="Statement">.</span><span class="PreProc">GetAbsolutePathName</span><span class="Statement">(</span>sDocFile<span class="Statement">)</span>

 <span class="Comment"> ' Debug outputs...</span>
  <span class="Statement">If</span> bShowDebug <span class="Statement">Then</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;Doc file = '&quot;</span> <span class="Statement">+</span> sDocFile <span class="Statement">+</span> <span class="Constant">&quot;'&quot;</span>
    WScript<span class="Statement">.</span>Echo <span class="Constant">&quot;PDF file = '&quot;</span> <span class="Statement">+</span> sPDFFile <span class="Statement">+</span> <span class="Constant">&quot;'&quot;</span>
  <span class="Statement">End</span> <span class="Statement">If</span>

  sFolder <span class="Statement">=</span> fso<span class="Statement">.</span><span class="PreProc">GetParentFolderName</span><span class="Statement">(</span>sDocFile<span class="Statement">)</span>

  <span class="Statement">If</span> <span class="Statement">Len</span><span class="Statement">(</span>sPDFFile<span class="Statement">)=</span><span class="Constant">0</span> <span class="Statement">Then</span>
    sPDFFile <span class="Statement">=</span> fso<span class="Statement">.</span><span class="PreProc">GetBaseName</span><span class="Statement">(</span>sDocFile<span class="Statement">)</span> <span class="Statement">+</span> <span class="Constant">&quot;.pdf&quot;</span>
  <span class="Statement">End</span> <span class="Statement">If</span>

  <span class="Statement">If</span> <span class="Statement">Len</span><span class="Statement">(</span>fso<span class="Statement">.</span><span class="PreProc">GetParentFolderName</span><span class="Statement">(</span>sPDFFile<span class="Statement">))=</span><span class="Constant">0</span> <span class="Statement">Then</span>
    sPDFFile <span class="Statement">=</span> sFolder <span class="Statement">+</span> <span class="Constant">&quot;\&quot;</span> <span class="Statement">+</span> sPDFFile
  <span class="Statement">End</span> <span class="Statement">If</span>

 <span class="Comment"> ' Enable this line if you want to disable autoexecute macros</span>
 <span class="Comment"> ' wdo.WordBasic.DisableAutoMacros</span>

 <span class="Comment"> ' Open the Word document</span>
  <span class="Statement">Set</span> wdoc <span class="Statement">=</span> wdocs<span class="Statement">.</span><span class="Statement">Open</span><span class="Statement">(</span>sDocFile<span class="Statement">)</span>

 <span class="Comment"> ' Let Word document save as PDF</span>
 <span class="Comment"> ' - for documentation of SaveAs() method,</span>
 <span class="Comment"> '   see <a href="http://msdn2.microsoft.com/en-us/library/bb221597.aspx">http://msdn2.microsoft.com/en-us/library/bb221597.aspx</a> </span>
  wdoc<span class="Statement">.</span><span class="PreProc">SaveAs</span> sPDFFile<span class="Statement">,</span> wdFormatPDF

  wdoc<span class="Statement">.</span><span class="Statement">Close</span> WdDoNotSaveChanges
  wdo<span class="Statement">.</span><span class="PreProc">Quit</span> WdDoNotSaveChanges
  <span class="Statement">Set</span> wdo <span class="Statement">=</span> <span class="Statement">Nothing</span>

  <span class="Statement">Set</span> fso <span class="Statement">=</span> <span class="Statement">Nothing</span>

<span class="Statement">End</span> <span class="Statement">Function</span>

<span class="Comment">' *** MAIN **************************************</span>

<span class="Statement">Call</span> EchoLogo<span class="Statement">()</span>
<span class="Statement">Call</span> EchoUsage<span class="Statement">()</span>
<span class="Statement">Call</span> CheckArgs<span class="Statement">()</span>
<span class="Statement">Call</span> DOC2PDF<span class="Statement">(</span> arguments<span class="Statement">.</span>Unnamed<span class="Statement">.</span><span class="PreProc">Item</span><span class="Statement">(</span><span class="Constant">0</span><span class="Statement">),</span> arguments<span class="Statement">.</span>Named<span class="Statement">.</span><span class="PreProc">Item</span><span class="Statement">(</span><span class="Constant">&quot;o&quot;</span><span class="Statement">)</span> <span class="Statement">)</span>

<span class="Statement">Set</span> arguments <span class="Statement">=</span> <span class="Statement">Nothing</span>
</pre>
</body>
</html>
